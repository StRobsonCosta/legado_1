CREATE PROCEDURE PRC_ATUALIZA_SALDO (
    IN P_CONTA VARCHAR(20)
)
LANGUAGE SQL
BEGIN
    UPDATE TB_CONTAS
    SET SALDO = SALDO +
        (SELECT COALESCE(SUM(VALOR),0)
         FROM TB_TRANSACOES
         WHERE CONTA = P_CONTA
         AND DATA_MOV = CURRENT_DATE)
    WHERE CONTA = P_CONTA;
END

